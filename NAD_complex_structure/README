
## get anoImb nuclear sequences
for i in $(ls ND_alignments/ | cut -d_ -f1 | s -u); do get_seq_by_name_fasta.py -n Aimb -f ND_alignments/${i}_aa.fasta | sed "s/Aimb/$i/"; done > anoImb_mt_ND_models/nuclear_prot.anoImb.aa.fasta


## get anoImb MT sequences
for i in $(ls mt_alignments/ | cut -d_ -f1 | s -u); do get_seq_by_name_fasta.py -n Aimb_genome -f mt_alignments/${i}_35tax_aa.fasta | sed "s/Aimb_genome/$i/"; done > anoImb_mt_ND_models/mt_prot.anoImb.aa.fasta

## map sites of interest onto structure
map_sites_on_structure.py -p anoImb_mt_ND_models/anoImb.ND1.model.pdb -s 46,79,143,163,168,223,254,258,262,314,315 -f anoImb_mt_ND_models/anoImb.ND1.aa.fasta > anoImb_mt_ND_models/anoImb.ND1.model.BEB.pdb


## color models by delta dN (repalce B-factor with delta dN values)
for g in $(ls anoImb_mt_ND_models/*pdb | cut -d/ -f2 | cut -d. -f2 | s -u); do echo $g; b=$(grep -w $g dN_values.ND_genes.tsv | cut -f5);  awk -v var=$b '{if ($1 == "ATOM" || $1 == "HETATM") printf "%-60s%6.2f%s\n", substr($0, 1, 60), var, substr($0, 67); else print $0}' anoImb_mt_ND_models/anoImb.$g.model.pdb > anoImb_mt_ND_models/anoImb.$g.model.ddN.pdb; done


## write pymol script
for g in $(ls anoImb_mt_ND_models/*pdb | cut -d/ -f2 | cut -d. -f2 | s -u | g ^ND); do echo "load anoImb_mt_ND_models/anoImb.$g.model.ddN.pdb"; echo "align anoImb.$g.model.ddN, 5lnk "; done > load_and_align_all_NDs.pml



## PyMol
select beb_nd1, resi 46+79+143+163+168+223+254+258+262+314+315 and anoImb.ND1.model.BEB
select beb_nd3, resi 10+20+62+84+87+94 and anoImb.ND3.model
select bebe_ndufs2, resi 29 and anoImb.NDUFS2.model 

bg_color white
spectrum b, blue_white_red, minimum=-5, maximum=5
hide cartoon, !(ss H+S)
